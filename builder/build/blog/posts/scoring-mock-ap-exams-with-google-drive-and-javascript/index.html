<!doctype html>
<html class="no-js" lang="en">
<head>
    <meta charset="utf-8">
    <title>
        blog | Scoring Mock AP Exams with Google Drive and JavaScript
    </title>
    <meta name="description" content="Cameron Lane's homepage.">
    <meta name="viewport" content="width=device-width">
    <link rel="shortcut icon" href="/static/favicon.ico">
    
    
    <link rel="stylesheet" type="text/css" href="/static/css/style.css?b8109c33">
    
    
</head>
<body class="blog">
    <div class="container">
        <header class="main-title">
            <h1><a href="/">Cameron <strong>Lane</strong></a></h1>
            <small>Erstwhile educator. Python programmer.</small>
        </header>
        <div class="contents">
            
    
     <h1>Scoring Mock AP Exams with Google Drive and JavaScript</h1>
<p>One of the biggest pains about giving mock AP exams to students is converting their scores on the mock exam to something on the AP scale.  There are many scales posted for individual practice exams, so I usually just pick one. For this year, a score of 62 or better (out of 80) qualified as a five on the AP scale, while greater than 47 was a four.</p>
<p>Usually I keep my grading sheets in a Google Drive spreadsheet which makes computing class averages, medians and standard deviations super simple. Unfortunately, converting from a raw score to this AP scale proved to be trickier than I would have liked. Case in point, if I wanted to write a spreadsheet 'formula' for this conversion, it would look something like this:</p>
<p>=IF(H2 &gt; 62, 5,IF(H2, &gt; 47, 4, IF(H2 &gt; 37, 3,...)))</p>
<p>This is an ugly solution to a really simple problem.  I've truncated the rest of the formula to save some space and avoid going through matching parenthesis hell for a second time. Even worse, it is not immediately clear what this function is doing. The long string of <code>if...else</code> statements makes it more difficult to follow what is happening than should be necessary.</p>
<h2>Enter JavaScript</h2>
<p>Luckily Google Drive provides its own scripting environment - a flavor of JavaScript once known as Google AppScript. At its most basic, this scripting environment allows users to create their own functions. However, it is also robust enough to support full-fledged applications that leverage the infrastructure of Drive. Cool stuff.  Anyway, I found it was much easier to write a user defined function called <code>APScoring()</code> that made it much easier to read my spreadsheet and debug my code.</p>
<pre><code>function APScoring(raw_score) {
/**
* Computes the AP Score for a given range of values
*/
if (raw_score &gt;= 62) 
  val = 5;
else if (raw_score &gt;=47)
  val = 4;
else if (raw_score &gt;= 37)
  val = 3;
else if (raw_score &gt;= 27)
  val = 2;
else
  val = 1;
return val;
};
</code></pre>
<p>The function accepts a number as input, then compares it to boundary values for AP Scoring of a certain exam.  That's it! Now, instead of an ugly string of <code>if...else</code> statements in my spreadsheet (repeated for every student), I have encapsulated this in my very own function which I can call like any other spreadsheet function.  That is, I can call it by using its name and passing it a value through a cell reference. So easy and so much cleaner.</p>
<p>This is a quick-and-dirty solution to be sure, and there are numerous ways to improve it. For example, it would be fairly simple to alter the function to accept an array of values corresponding to the boundaries between scoring levels. That would make it a bit more flexible by allowing users to specify the criteria for each AP score. As it is, it worked nicely for me. </p>
<p>In summary, Google's scripting environment for Drive makes it easy to automate and/or simplify tasks that are cumbersome through the traditional spreadsheet interface.</p>
     

    <div id="disqus_thread"></div>

        </div>
        <nav class="sidebar">
            <ul>
                <li class="home"><a href="/">home</a></li>
                <li class="blog"><a href="/blog/">blog</a></li>
                <li class="resume"><a href="/resume/">resume</a></li>
                <li class="contact"><a href="/contact/">contact</a></li>
            </ul>
        </nav>
        <footer class="site-footer">
            <p>
                &copy; 2012-2015 Cameron Lane
                - <a href="http://github.com/crlane">GitHub</a>
                - <a href="http://twitter.com/crlane">Twitter</a> 
            </p>
        </footer>
    </div>
    
        
    
    <script type="text/javascript" src="/static/js/app.js?d278a4a6"></script>
    
    
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'crlane'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
</body>
</html>